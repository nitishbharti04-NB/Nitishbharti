<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NITI Professional Assessment Portal</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Pinyon+Script&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
    /* App Interface Styles */
    body { margin:0; font-family:'Montserrat', sans-serif; background:#121217; color:white; }
    .container { max-width:1000px; margin:40px auto; padding:20px; }
    .card { background:white; color:#222; padding:28px; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.45); }
    .btn { background:linear-gradient(135deg,#003366,#00509d); color:white; border:none; padding:12px 20px; border-radius:6px; cursor:pointer; font-weight:700; font-size:16px; transition:0.15s; }
    .btn:hover { transform:translateY(-2px); }
    input[type="text"], input[type="email"] { width:100%; padding:12px; margin:10px 0; border:1px solid #ccc; border-radius:6px; font-size:16px; box-sizing:border-box; }
    #timer { font-size:20px; color:#ffcc00; text-align:center; margin-bottom:10px; font-weight:700; }
    .option { display:block; background:#f9f9f9; padding:12px; margin:10px 0; border:1px solid #eee; border-radius:8px; cursor:pointer; color:#222; }
    .option input { margin-right:10px; }
    .muted { color:#666; font-size:13px; }
    .center { text-align:center; }

    /* Certificate CSS */
    .cert-container { width:1000px; height:650px; padding:20px; background:#003366; position:relative; margin: 18px auto; box-sizing:border-box; }
    .cert-inner-frame { background:#fff; background-image: radial-gradient(#fff, #fdfbf2); height:100%; width:100%; border:4px solid #c5a059; padding:40px; box-sizing:border-box; position:relative; text-align:center; }
    .cert-title { font-family:Cinzel, serif; font-size:42px; color:#1a1a1a; margin:0; border-bottom:3px solid #c5a059; display:inline-block; padding-bottom:6px; }
    .cert-subtext { text-transform:uppercase; font-size:14px; color:#555; margin-top:18px; }
    .cert-name { font-family:Pinyon Script, cursive; font-size:64px; color:#003366; margin:16px 0; }
    .cert-course-line { font-size:20px; color:#333; }
    .cert-stats { margin-top:18px; font-size:16px; color:#444; }
    .cert-footer-link { font-size:13px; color:#777; margin-top:20px; }
    .niti-label { font-family:Cinzel, serif; font-size:18px; color:#003366; font-weight:700; margin-top:18px; }
    .cert-id-tag { display:inline-block; margin-top:8px; padding:6px 12px; background:#f0f0f0; border-radius:6px; font-weight:700; color:#000; border:1px solid #ddd; }

    .cert-bottom { display:flex; justify-content:space-between; align-items:flex-end; position:absolute; bottom:40px; left:40px; right:40px; }
    .seal-box { width:120px; height:120px; background: radial-gradient(circle,#f9d976,#f39c12); border-radius:50%; border:3px dashed #7d5a00; display:flex; align-items:center; justify-content:center; color:#7d5a00; font-weight:700; text-align:center; box-shadow:0 5px 15px rgba(0,0,0,0.2); }
    .sig-area { text-align:center; width:220px; }
    .sig-name { font-family:Pinyon Script, cursive; font-size:28px; color:#000; margin-bottom:-8px; }
    .sig-line { border-top:2px solid #333; padding-top:6px; font-weight:700; font-size:14px; color:#000; }

    .controls { display:flex; gap:10px; justify-content:center; margin-top:12px; }
    .controls .btn.secondary { background:#666; }

    /* small screens */
    @media (max-width:900px) {
      .container { padding:10px; }
      .cert-container { width:100%; height:auto; }
      .cert-inner-frame { padding:20px; }
    }
</style>
</head>
<body>

<div class="container">
  <!-- Landing -->
  <div id="landing-card" class="card" style="text-align:center;">
    <h1 style="color:#003366">Welcome to NITI Professional Assessment</h1>
    <p class="muted">Click Start to begin — you'll enter your name & email, choose a segment, then take a 15-question hard test.</p>
    <button class="btn" onclick="showLogin()">Start Test</button>
  </div>

  <!-- Login (name/email) -->
  <div id="login-card" class="card" style="display:none;">
    <h2 style="color:#003366">Enter Your Details</h2>
    <input id="inputName" type="text" placeholder="Full name (for certificate)">
    <input id="inputEmail" type="email" placeholder="Email address">
    <div style="display:flex; gap:10px; margin-top:8px;">
      <button class="btn" style="flex:1" onclick="submitUser()">Continue</button>
      <button class="btn secondary" style="flex:1" onclick="backToLanding()">Back</button>
    </div>
    <p class="muted" style="margin-top:12px;">We store session locally for demo purposes. For production use, connect a backend.</p>
  </div>

  <!-- Subject selection -->
  <div id="subject-card" class="card" style="display:none;">
    <h2 style="color:#003366">Choose your Segment</h2>
    <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:12px; margin-top:12px;">
      <button class="btn" onclick="beginTest('Excel')">Excel</button>
      <button class="btn" onclick="beginTest('Advanced Excel')">Advanced Excel</button>
      <button class="btn" onclick="beginTest('SQL')">SQL</button>
      <button class="btn" onclick="beginTest('Power BI')">Power BI</button>
      <button class="btn" onclick="beginTest('Python')">Python</button>
    </div>
    <p class="muted" style="margin-top:12px;">Each test: 15 hard questions chosen randomly from a large pool. Retakes avoid repeating the immediate previous set for the same email + segment.</p>
  </div>

  <!-- Quiz -->
  <div id="quiz-card" style="display:none;">
    <div id="timer" class="muted"></div>
    <div id="question-card" class="card"></div>
  </div>

  <!-- Result / Certificate -->
  <div id="result-card" style="display:none;">
    <div id="cert-capture">
      <div class="cert-container">
        <div class="cert-inner-frame" id="certificateFrame">
          <div class="cert-title">Certificate of Completion</div>
          <div class="cert-subtext">This is to certify that</div>
          <div id="certName" class="cert-name">Candidate Name</div>
          <div class="cert-course-line">has successfully completed the <strong id="certSkill">Skill Test</strong></div>

          <div class="cert-stats">
            <strong>Score:</strong> <span id="certScore">0/15</span> &nbsp; | &nbsp;
            <strong>Grade:</strong> <span id="certGrade">Beginner</span> <br>
            <strong>Date:</strong> <span id="certDate"></span>
          </div>

          <div class="cert-footer-link">Thanks for visiting our page — <u>https://nitishbharti04-nb.github.io/Nitishbharti/</u></div>

          <div class="niti-label">NITI</div>
          <div id="certId" class="cert-id-tag">NITI CERT - XXXX</div>

          <div class="cert-bottom">
            <div class="seal-box">OFFICIAL<br>GRADUATE</div>
            <div class="sig-area">
              <div class="sig-name">Program Director</div>
              <div class="sig-line">Signature</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="btn" onclick="downloadCertificatePDF()">Download Official PDF Certificate</button>
      <button class="btn secondary" onclick="location.reload()">Take Another Test</button>
    </div>
  </div>
</div>

<script>
/* ---------------------------
   Configuration & State
   --------------------------- */
const POOL_SIZE_PER_SEGMENT = 140; // set between 100-200 as needed
const QUESTIONS_PER_TEST = 15;
const TIME_LIMIT_SECONDS = 20 * 60; // 20 minutes - configurable
let userName = '', userEmail = '';
let currentSegment = '';
let poolCache = {}; // pools cached in-memory (also saved to localStorage)
let currentTest = []; // selected questions for this attempt (questions have fields: id, q, options[], _answerIndex)
let userResponses = [];
let currentIndex = 0;
let remainingSeconds = TIME_LIMIT_SECONDS;
let timerInterval = null;

/* ---------------------------
   Helpers
   --------------------------- */
function show(id){ document.getElementById(id).style.display = ''; }
function hide(id){ document.getElementById(id).style.display = 'none'; }
function nowISO(){ return new Date().toISOString(); }
function genCertId(){ return 'NITI-' + Math.random().toString(36).substring(2,10).toUpperCase(); }
function shuffle(arr){ const a = arr.slice(); for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
function sample(arr,k){ if(k>=arr.length) return arr.slice(); const out=[], used=new Set(); while(out.length<k){ const i=Math.floor(Math.random()*arr.length); if(!used.has(i)){ used.add(i); out.push(arr[i]); }} return out; }
function escapeHtml(s){ return String(s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'","&#39;"); }

/* ---------------------------
   UI Flow: landing -> login -> subject -> quiz -> result
   --------------------------- */
function showLogin(){ hide('landing-card'); show('login-card'); }
function backToLanding(){ hide('login-card'); show('landing-card'); }
function submitUser(){
  const n = document.getElementById('inputName').value.trim();
  const e = document.getElementById('inputEmail').value.trim();
  if(!n) return alert('Please enter your full name.');
  if(!e) return alert('Please enter your email.');
  userName = n; userEmail = e.toLowerCase();
  hide('login-card'); show('subject-card');
}

/* ---------------------------
   Pool generation (unique questions & option text)
   --------------------------- */
function getOrCreatePool(segment){
  // Try memory first
  if(poolCache[segment]) return poolCache[segment];
  // Try localStorage
  const key = `niti_pool_${segment}`;
  const saved = localStorage.getItem(key);
  if(saved){
    poolCache[segment] = JSON.parse(saved);
    return poolCache[segment];
  }
  // Generate pool and persist
  const pool = generatePoolForSegment(segment, POOL_SIZE_PER_SEGMENT);
  poolCache[segment] = pool;
  localStorage.setItem(key, JSON.stringify(pool));
  return pool;
}

function generatePoolForSegment(segment, size){
  // Banks and templates per segment - large lists for realistic variation
  const banks = {
    "Excel": ["TODAY()", "NOW()", "VLOOKUP()", "INDEX()", "MATCH()", "SUM()", "AVERAGE()", "COUNT()", "COUNTA()", "IF()", "SUMIF()", "CONCAT()", "TEXT()", "LEFT()", "RIGHT()", "MID()", "TRIM()", "PROPER()", "UPPER()", "LOWER()", "REMOVE DUPLICATES", "FILTER()", "SORT()", "UNIQUE()", "XLOOKUP()", "TRANSPOSE()", "ROUND()", "RAND()", "RANDBETWEEN()", "PMT()", "SUBTOTAL()", "PIVOT TABLE", "FLASH FILL", "F9"],
    "Advanced Excel": ["LET()", "LAMBDA()", "XLOOKUP()", "FILTER()", "SEQUENCE()", "SORTBY()", "UNIQUE()", "INDEX-MATCH", "Power Query", "Power Pivot", "DAX SUMX", "CALCULATE()", "EARLIER()", "OFFSET()", "INDIRECT()", "ARRAY FORMULA", "SLICER", "WHAT-IF", "GOAL SEEK", "SCENARIO MANAGER", "GETPIVOTDATA()", "XMATCH()", "TEXTJOIN()", "IFS()", "SWITCH()", "SPILL", "DYNAMIC ARRAYS", "POWER MAP"],
    "SQL": ["SELECT", "WHERE", "GROUP BY", "ORDER BY", "JOIN", "LEFT JOIN", "INNER JOIN", "RIGHT JOIN", "INSERT INTO", "UPDATE", "DELETE", "DISTINCT", "HAVING", "COUNT()", "SUM()", "AVG()", "MIN()", "MAX()", "CREATE TABLE", "ALTER TABLE", "DROP TABLE", "INDEX", "PRIMARY KEY", "FOREIGN KEY", "TRANSACTION", "COMMIT", "ROLLBACK", "UNION", "EXISTS", "IN"],
    "Power BI": ["Power Query", "Power Pivot", "DAX", "M language", "Measure", "Calculated Column", "Visualization", "Report View", "Data Model", "Relationships", "Slicer", "Publish", "Get Data", "Transform", "Merge Queries", "Append Queries", "Bookmarks", "Drillthrough", "Row-level security", "Dataflows", "Gateway", "Refresh", "Query Folding"],
    "Python": ["def", "for", "while", "tuple", "list", "dict", "set", "len()", "print()", "import", "from", "lambda", "map()", "filter()", "list comprehension", "generator", "yield", "None", "True", "False", "str()", "int()", "float()", "open()", "with", "try/except", "class", "self", "range()", "enumerate()"]
  };

  const templates = {
    "Excel": [
      "Which function returns the current date/time?",
      "Which feature removes duplicate rows in a dataset?",
      "Which function counts numeric entries in a range?",
      "Which function retrieves a value from the leftmost column?",
      "Which function returns position of an item in a range?"
    ],
    "Advanced Excel": [
      "Which new Excel function provides dynamic arrays?",
      "Which combination is preferred instead of VLOOKUP for flexibility?",
      "Which language is used for measures in Power Pivot?",
      "Which Excel feature helps ETL large datasets?",
      "Which function lets you define reusable custom formulas?"
    ],
    "SQL": [
      "Which clause filters rows in a SELECT?",
      "Which statement inserts rows into a table?",
      "Which keyword removes duplicates from results?",
      "Which JOIN returns all rows from left plus matches on right?",
      "Which clause groups rows for aggregates?"
    ],
    "Power BI": [
      "Which component transforms raw data in Power BI?",
      "Which language is used for measures in Power BI?",
      "Which visual is ideal for trends over time?",
      "Which feature merges queries in Power Query?",
      "Which feature secures data at user level?"
    ],
    "Python": [
      "Which keyword defines a function in Python?",
      "Which statement loops over iterable items?",
      "Which data type is immutable: list or tuple?",
      "Which symbol begins a comment in Python?",
      "Which built-in returns the length of an object?"
    ]
  };

  const bank = banks[segment] || banks["Excel"];
  const base = templates[segment] || templates["Excel"];

  // ensure extended bank size
  let ext = bank.slice();
  while(ext.length < 60) ext = ext.concat(bank.map((b,i)=> b + " " + ((i%10)+1)));

  const pool = [];
  for(let i=0;i<size;i++){
    const textTemplate = base[i % base.length];
    const variant = Math.floor(i / base.length) + 1;
    const questionText = `${segment} — Q${i+1}: ${textTemplate} (variant ${variant})`;
    // choose a correct answer deterministically but varied
    const correct = ext[(i * 7) % ext.length];
    // pick 3 unique distractors
    const distractors = [];
    let attempts = 0;
    while(distractors.length < 3 && attempts < 100){
      const cand = ext[Math.floor(Math.random()*ext.length)];
      if(cand !== correct && distractors.indexOf(cand) === -1) distractors.push(cand);
      attempts++;
    }
    const options = shuffle([correct, ...distractors]);
    const correctIndex = options.indexOf(correct);
    pool.push({ id: `${segment}-${i+1}`, q: questionText, options, _answerIndex: correctIndex, difficulty: 'hard' });
  }
  return pool;
}

/* ---------------------------
   Choose questions for a test while avoiding immediate repeat for same email+segment
   --------------------------- */
function selectQuestionsForAttempt(segment, email, k){
  const pool = getOrCreatePool(segment);
  const lastKey = `niti_last_${email}_${segment}`;
  const prev = JSON.parse(localStorage.getItem(lastKey) || 'null');
  const prevIds = prev ? prev.ids : null;
  const maxAttempts = 60;
  for(let attempt=0; attempt<maxAttempts; attempt++){
    const sampleQs = sample(pool, k);
    const ids = sampleQs.map(x => x.id);
    const overlap = prevIds ? ids.filter(id => prevIds.includes(id)).length : 0;
    if(!prevIds || overlap === 0){
      // shuffle options per question to vary correct letter
      const prepared = sampleQs.map(q => shuffleQuestionOptions(q));
      localStorage.setItem(lastKey, JSON.stringify({ ids: prepared.map(p=>p.id), time: nowISO() }));
      return prepared;
    }
  }
  // fallback: return any sample with option shuffle
  return sample(pool, k).map(q => shuffleQuestionOptions(q));
}

/* Shuffle options for a question object and recalc _answerIndex */
function shuffleQuestionOptions(q){
  const opts = q.options.slice();
  const originalCorrect = q.options[q._answerIndex];
  const shuffled = shuffle(opts);
  const newIndex = shuffled.indexOf(originalCorrect);
  return { id: q.id, q: q.q, options: shuffled, _answerIndex: newIndex, difficulty: q.difficulty };
}

/* ---------------------------
   Test start / rendering / navigation
   --------------------------- */
function beginTest(segment){
  currentSegment = segment;
  hide('subject-card');
  show('quiz-card');

  // select 15 questions for this attempt avoiding immediate previous sample
  currentTest = selectQuestionsForAttempt(segment, userEmail, QUESTIONS_PER_TEST);
  userResponses = new Array(currentTest.length).fill(null);
  currentIndex = 0;
  remainingSeconds = TIME_LIMIT_SECONDS;
  renderQuestion();
  startTimer();
}

function startTimer(){
  document.getElementById('timer').textContent = formatTime(remainingSeconds);
  if(timerInterval) clearInterval(timerInterval);
  timerInterval = setInterval(()=>{
    remainingSeconds--;
    document.getElementById('timer').textContent = `Time Left: ${formatTime(remainingSeconds)}`;
    if(remainingSeconds <= 0){ clearInterval(timerInterval); finishTest(); }
  }, 1000);
}
function formatTime(sec){ const m=Math.floor(sec/60), s=sec%60; return `${m}:${s<10?'0'+s:s}`; }

function renderQuestion(){
  const card = document.getElementById('question-card');
  const q = currentTest[currentIndex];
  const opts = q.options.map((o, idx) => {
    const checked = userResponses[currentIndex] === idx ? 'checked' : '';
    return `<label class="option"><input type="radio" name="opt" value="${idx}" ${checked}> ${escapeHtml(o)}</label>`;
  }).join('');
  const navPrev = currentIndex > 0 ? `<button class="btn secondary" onclick="prevQuestion()">Previous</button>` : '';
  const navNext = currentIndex < currentTest.length - 1 ? `<button class="btn" onclick="nextQuestion()">Next</button>` : `<button class="btn" onclick="finishTest()">Finish Test</button>`;
  card.innerHTML = `
    <h3 style="color:#003366">Question ${currentIndex+1} / ${currentTest.length} <small class="muted">(${q.difficulty})</small></h3>
    <p style="font-weight:700; font-size:18px;">${escapeHtml(q.q)}</p>
    <div style="margin-top:8px;">${opts}</div>
    <div style="margin-top:18px; display:flex; gap:10px; justify-content:center;">${navPrev} ${navNext}</div>
    <p class="muted" style="margin-top:12px;">Answered: ${userResponses.filter(x=>x!==null).length} • Unanswered: ${userResponses.filter(x=>x===null).length}</p>
  `;
  // ensure first input focused
  setTimeout(()=>{ const first = card.querySelector('input[name="opt"]'); if(first) first.focus(); }, 50);
}

function saveCurrentAnswer(){
  const sel = document.querySelector('input[name="opt"]:checked');
  if(sel) userResponses[currentIndex] = parseInt(sel.value);
}

function nextQuestion(){
  saveCurrentAnswer();
  if(currentIndex < currentTest.length - 1){ currentIndex++; renderQuestion(); }
}

function prevQuestion(){
  saveCurrentAnswer();
  if(currentIndex > 0){ currentIndex--; renderQuestion(); }
}

/* ---------------------------
   Finish and scoring
   --------------------------- */
function finishTest(){
  // save last answer
  saveCurrentAnswer();
  if(timerInterval) clearInterval(timerInterval);

  let score = 0;
  for(let i=0;i<currentTest.length;i++){
    const q = currentTest[i];
    if(typeof userResponses[i] === 'number' && userResponses[i] === q._answerIndex) score++;
  }
  const grade = score >= 12 ? 'Excellent' : (score >= 8 ? 'Advanced' : 'Beginner');
  const certId = genCertId();

  // save result record list
  const recsKey = 'niti_results';
  const recs = JSON.parse(localStorage.getItem(recsKey) || '[]');
  recs.push({ name: userName, email: userEmail, segment: currentSegment, score, total: currentTest.length, grade, certId, ts: nowISO() });
  localStorage.setItem(recsKey, JSON.stringify(recs));

  // show certificate
  document.getElementById('certName').textContent = userName;
  document.getElementById('certSkill').textContent = currentSegment + ' Test';
  document.getElementById('certScore').textContent = `${score}/${currentTest.length}`;
  document.getElementById('certGrade').textContent = grade;
  document.getElementById('certDate').textContent = new Date().toDateString();
  document.getElementById('certId').textContent = 'NITI CERT - ' + certId;

  hide('quiz-card');
  show('result-card');
}

/* ---------------------------
   Certificate PDF download (Landscape Letter)
   --------------------------- */
async function downloadCertificatePDF(){
  // capture the certificate frame element
  const el = document.getElementById('certificateFrame');
  if(!el) return alert('Certificate not found');
  // scale for better quality
  const canvas = await html2canvas(el, { scale: 2, useCORS: true, backgroundColor: null });
  const imgData = canvas.toDataURL('image/png');
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF({ orientation: 'landscape', unit: 'pt', format: 'letter' });
  const pageW = pdf.internal.pageSize.getWidth();
  const pageH = pdf.internal.pageSize.getHeight();
  const imgW = canvas.width;
  const imgH = canvas.height;
  const ratio = Math.min(pageW / imgW, pageH / imgH);
  const renderW = imgW * ratio;
  const renderH = imgH * ratio;
  const marginX = (pageW - renderW) / 2;
  const marginY = (pageH - renderH) / 2;
  pdf.addImage(imgData, 'PNG', marginX, marginY, renderW, renderH, undefined, 'FAST');
  const safeName = (userName || 'certificate').replace(/\s+/g,'_').replace(/[^\w\-\.]/g,'');
  pdf.save(`${safeName}_NITI_CERT.pdf`);
}

/* ---------------------------
   Subject start wrappers
   --------------------------- */
function beginTestWrap(segment){
  currentSegment = segment;
  beginTest(segment);
}

/* ---------------------------
   Initialization helpers
   --------------------------- */
function beginTestNameCheck(segment){
  // ensure name & email present; if user arrived here directly call submitUser flow
  if(!userName || !userEmail){
    alert('Please enter your name & email first.');
    show('login-card'); hide('subject-card');
    return;
  }
  beginTest(segment);
}

/* Starter functions for clickable buttons */
function beginIfReady(segment){
  if(!userName || !userEmail){
    // prompt to fill login section
    hide('landing-card');
    show('login-card');
    return;
  }
  beginTest(segment);
}

/* Event binding wrappers used in HTML */
function beginTestFromButton(segment){ beginIfReady(segment); }
function beginTestFromSubject(segment){ beginTest(segment); }

/* ---------------------------
   Expose functions used inline (for buttons)
   --------------------------- */
window.showLogin = showLogin;
window.backToLanding = backToLanding;
window.submitUser = submitUser;
window.beginTest = beginTest;
window.beginTestFromButton = beginTestFromButton;
window.beginTestFromSubject = beginTestFromSubject;
window.nextQuestion = nextQuestion;
window.prevQuestion = prevQuestion;
window.finishTest = finishTest;
window.downloadCertificatePDF = downloadCertificatePDF;

/* ---------------------------
   Small adaptation: wire subject buttons (so they ensure name/email)
   --------------------------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // wire subject card buttons to require name/email
  const subjectButtons = document.querySelectorAll('#subject-card .btn');
  subjectButtons.forEach(btn=>{
    btn.addEventListener('click', (e)=>{
      const seg = e.target.textContent.trim();
      // map label to exact segment keys
      const map = {
        'Excel': 'Excel', 'Advanced Excel': 'Advanced Excel', 'SQL':'SQL', 'Power BI':'Power BI', 'Python':'Python',
        'Advanced Excel':'Advanced Excel', 'Power BI Expert':'Power BI'
      };
      const targetSeg = seg in map ? map[seg] : seg;
      if(!userName || !userEmail){
        alert('Please enter name and email first.');
        show('login-card'); hide('subject-card');
        return;
      }
      beginTest(targetSeg);
    });
  });
});
</script>
</body>
</html>
