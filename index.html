<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Skill Test Portal</title>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:Segoe UI;
  background:linear-gradient(135deg,#141e30,#243b55);
  color:white;
}
.container{max-width:900px;margin:auto;padding:20px;}
.card{
  background:white;color:#333;padding:25px;border-radius:15px;
  margin-top:20px;box-shadow:0 15px 30px rgba(0,0,0,.3);
}
button{
  background:linear-gradient(135deg,#ff512f,#dd2476);
  color:white;border:none;padding:10px 20px;border-radius:25px;
  cursor:pointer;margin:5px;font-size:15px;
}
button:hover{transform:scale(1.05);}
input{padding:8px;border-radius:8px;border:1px solid #ccc;}
.correct{color:green;font-weight:bold;}
.wrong{color:red;font-weight:bold;}
</style>
</head>

<body>
<div class="container">
<h1>üéØ Skill Assessment Portal</h1>

<!-- LOGIN -->
<div id="login" class="card">
<h2>Login</h2>
<input id="username" placeholder="Enter your name">
<br><br>
<button onclick="login()">Login</button>
<button onclick="showAdmin()">Admin Panel</button>
</div>

<!-- ADMIN -->
<div id="admin" class="card" style="display:none">
<h2>Admin Panel</h2>
<input id="newQ" placeholder="Question">
<input id="a1" placeholder="Option A">
<input id="a2" placeholder="Option B">
<input id="a3" placeholder="Option C">
<input id="a4" placeholder="Option D">
<br><br>
<button onclick="addQuestion()">Add Question</button>
<button onclick="back()">Back</button>
</div>

<!-- MODE -->
<div id="mode" class="card" style="display:none">
<h2>Select Skill</h2>
<button onclick="startTest()">Start Test</button>
</div>

<div id="timer"></div>
<div id="quiz" class="card" style="display:none"></div>
<div id="review" class="card" style="display:none"></div>
<div id="result" class="card"></div>

</div>

<script>
let user="",index=0,score=0,timeLeft=300,timer;
let questions=JSON.parse(localStorage.getItem("questions"))||[
{q:"Python type?",o:["High","Low","Machine","None"],c:0},
{q:"SQL full form?",o:["Structured Query Language","Simple","None","Data"],c:0},
{q:"Excel company?",o:["Google","Microsoft","Apple","Amazon"],c:1},
{q:"Power BI use?",o:["Visualization","Coding","Design","Mail"],c:0}
];

let test=[],answers=[];

function login(){
 user=document.getElementById("username").value;
 if(!user)return alert("Enter name");
 document.getElementById("login").style.display="none";
 document.getElementById("mode").style.display="block";
}

function showAdmin(){
 document.getElementById("login").style.display="none";
 document.getElementById("admin").style.display="block";
}

function back(){location.reload();}

function addQuestion(){
 let q=document.getElementById("newQ").value;
 let o=[a1.value,a2.value,a3.value,a4.value];
 questions.push({q,o,c:Math.floor(Math.random()*4)});
 localStorage.setItem("questions",JSON.stringify(questions));
 alert("Question Added");
}

function shuffle(a){return a.sort(()=>Math.random()-0.5);}

function startTest(){
 document.getElementById("mode").style.display="none";
 document.getElementById("quiz").style.display="block";
 index=0;score=0;answers=[];
 test=shuffle([...questions]).slice(0,5);
 startTimer();
 showQ();
}

function startTimer(){
 timer=setInterval(()=>{
 let m=Math.floor(timeLeft/60),s=timeLeft%60;
 timerDiv.innerHTML=`‚è± ${m}:${s<10?"0"+s:s}`;
 if(timeLeft--<=0){clearInterval(timer);submit();}
 },1000);
}

function showQ(){
 let q=test[index];
 quiz.innerHTML=`
 <h3>Q ${index+1}/${test.length}</h3>
 <p>${q.q}</p>
 ${q.o.map((x,i)=>`
 <label><input type="radio" name="o" value="${i}"
 ${answers[index]==i?"checked":""}> ${x}</label><br>`).join("")}
 <br>
 ${index>0?'<button onclick="prev()">Prev</button>':''}
 ${index<test.length-1?'<button onclick="next()">Next</button>':'<button onclick="submit()">Submit</button>'}
 `;
}

function save(){
 let s=document.querySelector("input[name=o]:checked");
 if(s)answers[index]=Number(s.value);
}

function next(){save();index++;showQ();}
function prev(){save();index--;showQ();}

function submit(){
 clearInterval(timer);
 save();
 document.getElementById("quiz").style.display="none";
 review();
}

function review(){
 document.getElementById("review").style.display="block";
 review.innerHTML="<h2>Review</h2>";
 test.forEach((q,i)=>{
 let cls=answers[i]==q.c?"correct":"wrong";
 if(answers[i]==q.c)score++;
 review.innerHTML+=`
 <p>${i+1}. ${q.q}<br>
 Your Answer: <span class="${cls}">${q.o[answers[i]]||"Not Attempted"}</span><br>
 Correct: ${q.o[q.c]}</p>`;
 });
 review.innerHTML+=`<button onclick="certificate()">Generate Certificate</button>`;
}

function certificate(){
 review.style.display="none";
 let level=score>=4?"Advanced":score>=2?"Intermediate":"Beginner";
 result.innerHTML=`
 <h2>üèÜ Certificate</h2>
 <p>Name: <b>${user}</b></p>
 <p>Score: ${score}/${test.length}</p>
 <p>Level: ${level}</p>
 <button onclick="pdf()">Download PDF</button>
 <button onclick="location.reload()">Restart</button>`;
}

function pdf(){
 const {jsPDF}=window.jspdf;
 let pdf=new jsPDF();
 pdf.text("Certificate of Completion",60,30);
 pdf.text(`Name: ${user}`,20,50);
 pdf.text(`Score: ${score}`,20,60);
 pdf.text(`Level: ${score>=4?"Advanced":score>=2?"Intermediate":"Beginner"}`,20,70);
 pdf.save("certificate.pdf");
}
</script>
</body>
</html>
